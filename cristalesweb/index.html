<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Cristales</title>

<!-- Fuentes -->
<link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,700;1,400&display=swap" rel="stylesheet">

<style>
  body{
      font-family: 'Merriweather', serif;
      font-weight: 700;
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      align-items:center;
      min-height:100vh;
      margin:0;
      background-image: url("img/fondo.png");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      padding-top: 40px;
  }

  .titulo {
    position: absolute;
    top: 32px;
    left: 20px;
    color: #fff;
    font-family: 'Cinzel Decorative', serif;
    font-weight: 700;
    font-size: 2rem;
  }

  #tituloPrincipal {
    margin: 60px 0 10px 0;
    text-align: center;
    font-size: 1.5rem;
    color:#fff;
  }

  #tituloCristal {
    font-family: 'Merriweather', serif;
    font-weight: 700;
    color:#fff;
    margin: 60px 0 20px 0;
    text-align:center;
    font-size:2rem;
    display:none;
  }

  /* Texto final desbloqueado */
  #textoFinal {
    display: none;
    color: #fff;
    font-size: 1.3rem;
    font-style: italic;
    margin-top: 10px;
    text-decoration: underline;
    cursor: pointer;
    animation: palpitar 1.4s infinite ease-in-out;
    transform-origin: center;
    opacity: 0;
    transition: opacity 1s ease;
  }

  #textoFinal.mostrar {
    display: block;
    opacity: 1;
  }

  #textoFinal:hover {
    color: #E9CE99;
  }

  /* Efecto de palpitar */
  @keyframes palpitar {
    0%,100% { transform: scale(1); }
    50% { transform: scale(1.18); }
  }

  .contenedor{
    position:relative;
    width:100%;
    max-width:1000px;
    flex:1;
    display:flex;
    align-items:center;
    justify-content:center;
    margin-top:20px;
  }

  .grilla {
    position: relative;
    width: 100%;
    height: 500px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    transition: background-image 0.6s ease-in-out;
  }
  .grilla.oculto { display:none; }

  .cristalCaja {
    position:absolute;
    width: clamp(90px, 14vw, 180px);
    aspect-ratio:1/1;
    display:flex;
    align-items:center;
    justify-content:center;
    transition: all 1.2s ease;
    opacity:1;
    cursor:pointer;
  }

  .cristalCaja img{
    width:100%;
    height:100%;
    object-fit:contain;
    pointer-events:none;
    transition: transform 0.4s ease;
  }

  .cristalCaja.inhabilitado { pointer-events:none; cursor:default; }

  .izq-arriba   { top:20%; left:25%; transform:translate(-50%,-50%); }
  .izq-abajo    { top:70%; left:25%; transform:translate(-50%,-50%); }
  .centro       { top:45%; left:50%; transform:translate(-50%,-50%); width: clamp(120px, 18vw, 240px); }
  .der-arriba   { top:20%; left:75%; transform:translate(-50%,-50%); }
  .der-abajo    { top:70%; left:75%; transform:translate(-50%,-50%); }

  .palpitando {
    animation: palpitar 1.3s infinite ease-in-out;
    transform-origin:center;
  }

  .detalleCristal {
    display:none;
    width:100%;
    max-width:900px;
    align-items:center;
    justify-content:center;
    gap:40px;
  }
  .detalleCristal.visible { display:flex; }

  .textoCampo {
    max-width: auto;
    padding: 20px;
    font-size: 24px;
    color: #ffff;
    line-height: 1.6;
    font-family: 'Merriweather', serif;
    font-weight: 400;
    font-style: italic;
  }

  .cristal-grande {
    width: clamp(420px, 25vw, 380px);
    height: clamp(420px, 20vw, 320px);
    flex-shrink:0;
    cursor:pointer;
  }

  .cristal-grande img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    animation: brilloPulse 2s infinite ease-in-out;
  }

  @keyframes brilloPulse {
    0% { filter: drop-shadow(0 0 10px #E9CE99); }
    50% { filter: drop-shadow(0 0 15px #E9CE99); }
    100% { filter: drop-shadow(0 0 10px #E9CE99); }
  }

  /* === Layout final cuando se completa todo === */
  .grilla.finalLayout .izq-arriba { top: 40%; left: 35%; transform: translate(-50%, -50%); }
  .grilla.finalLayout .izq-abajo  { top: 55%; left: 35%; transform: translate(-50%, -50%); }
  .grilla.finalLayout .centro     { top: 47%; left: 50%; transform: translate(-50%, -50%); }
  .grilla.finalLayout .der-arriba { top: 40%; left: 65%; transform: translate(-50%, -50%); }
  .grilla.finalLayout .der-abajo  { top: 55%; left: 65%; transform: translate(-50%, -50%); }
  .grilla.finalLayout .cristalCaja { transition: all 1.2s ease; }

  /* Posiciones nuevas al “acercarse” al cristal celeste */
  #cRosa.acercado { top: 50% !important; left: 40% !important; }
  #cVioleta.acercado { top: 40% !important; left: 60% !important; }
  #cVerde.acercado { top: 58% !important; left: 45% !important; }
  #cAmarillo.acercado { top: 58% !important; left: 55% !important; }

  #grillaCristales {
    background-size: 90% !important;
    background-position: 25% -30px !important;
    background-repeat: no-repeat !important;
  }

#fondoFinal {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  width: min(90%, 1000px);
  aspect-ratio: 16 / 9;
  cursor: pointer;
  z-index: 9999;
  animation: palpitarFinal 1.6s infinite ease-in-out;
}

@keyframes palpitarFinal {
  0%, 100% { transform: translate(-50%, -50%) scale(1); }
  50% { transform: translate(-50%, -50%) scale(1.18); }
}

</style>
</head>
<body>

  <div class="titulo">Mortalis</div>

  <h1 id="tituloPrincipal">FAMILIA DE CRISTALES</h1>
  <h1 id="tituloCristal"></h1>

  <div class="contenedor">
    <div id="grillaCristales" class="grilla">

      <div id="cRosa" class="cristalCaja izq-arriba">
        <img src="img/cristales/cristalrosa.png"
             data-disabled="img/cristales/cristalrosabyn.png"
             data-NombreCristal="Rodonita"
             class="palpitando">
      </div>

      <div id="cVioleta" class="cristalCaja der-arriba inhabilitado">
        <img src="img/cristales/cristalvioleta.png"
             data-disabled="img/cristales/cristalvioletabyn.png"
             data-NombreCristal="Amatista">
      </div>

      <div id="cVerde" class="cristalCaja izq-abajo inhabilitado">
        <img src="img/cristales/cristalverde.png"
             data-disabled="img/cristales/cristalverdebyn.png"
             data-NombreCristal="Jade">
      </div>

      <div id="cAmarillo" class="cristalCaja der-abajo inhabilitado">
        <img src="img/cristales/cristalamarillo.png"
             data-disabled="img/cristales/cristalamarillobyn.png"
             data-NombreCristal="Citrino">
      </div>

      <div id="cCeleste" class="cristalCaja centro inhabilitado">
        <img src="img/cristales/cristalceleste.png"
             data-disabled="img/cristales/cristalcelestebyn.png"
             data-NombreCristal="Cristal de Selen">
      </div>

    </div>

    <div class="detalleCristal" id="detalleCristal"></div>
  </div>

 <img id="fondoFinal" src="img/cristales/cristalesfinal.png" alt="Final" />

<script>
/* ---- Configuración ---- */
const arrayCristal = ['cRosa','cVioleta','cVerde','cAmarillo','cCeleste'];
const activacion = new Set(['cRosa']);
let IdentidadCristal = null;
let ultimoRevisado = null;
let progresoCristales = -1;
const collected = new Set();

/* ---- refs DOM ---- */
const grillaCristales = document.getElementById("grillaCristales");
const detalleCristal  = document.getElementById("detalleCristal");
const tituloPrincipal = document.getElementById("tituloPrincipal");
const tituloCristal   = document.getElementById("tituloCristal");
const fondoFinal      = document.getElementById("fondoFinal");

/* ---- actualizar fondo según progreso ---- */
function actualizarFondo(paso){
  if (paso === null || paso === undefined || paso < 0) {
    grillaCristales.style.backgroundImage = ''; 
    return;
  }

  const pad = String(paso).padStart(2,'0');
  const ruta = `img/cristales/cristalesunidos${pad}.png`;

  if(pad !== '04'){
    grillaCristales.style.backgroundImage = `url('${ruta}')`;
  }
}

/* ---- marcar inhabilitados (BYN) ---- */
document.querySelectorAll(".cristalCaja.inhabilitado img").forEach(img => {
  if (img.dataset.disabled) {
    img.dataset.enabled = img.src;
    img.src = img.dataset.disabled;
  }
});

/* ---- activar siguiente ---- */
function activate(id){
  const cristalCaja = document.getElementById(id);
  if(!cristalCaja || !cristalCaja.classList.contains('inhabilitado')) return;
  cristalCaja.classList.remove('inhabilitado');
  const img = cristalCaja.querySelector('img');
  if(img && img.dataset.enabled){ img.src = img.dataset.enabled; }
  if(img) img.classList.add('palpitando');
  activacion.add(id);
}

/* ---- ocultar cristal ---- */
function ocultarCristal(id){
  const el = document.getElementById(id);
  if(el) el.style.display = 'none';
  collected.add(id);
}

/* ---- cerrar y unir ---- */
function cerrarDetalleYUnir(id){
  if(!id) return;
  IdentidadCristal = null;
  detalleCristal.classList.remove("visible");
  detalleCristal.innerHTML = "";
  grillaCristales.classList.remove("oculto");
  tituloPrincipal.style.display = "block";
  tituloCristal.style.display = "none";

  if(!collected.has(id)){
    progresoCristales++;
    actualizarFondo(progresoCristales);

    if (progresoCristales === 0) {
      const cCeleste = document.getElementById('cCeleste');
      if (cCeleste) cCeleste.style.display = 'none';
    }

    if (progresoCristales === 3) {
      const cCeleste = document.getElementById('cCeleste');
      if (cCeleste) {
        cCeleste.style.display = 'flex';
        const imgCeleste = cCeleste.querySelector('img');
        if (imgCeleste) imgCeleste.classList.add('palpitando');
        activate('cCeleste');
      }
    }

    ocultarCristal(id);
    const idx = arrayCristal.indexOf(id);
    const siguiente = arrayCristal[idx + 1];
    if(siguiente) activate(siguiente);
  }

  if(id === 'cCeleste' && activacion.size === arrayCristal.length){
    // Mostrar fondo final
    fondoFinal.style.display = 'block';
    grillaCristales.classList.add("finalLayout");

    // Desactivar cristalesunidos03.png si estaba activo
    if (grillaCristales.style.backgroundImage.includes("cristalesunidos03.png")) {
        grillaCristales.style.backgroundImage = '';
    }
  }
}

/* ---- eventos ---- */
arrayCristal.forEach(id => {
  const cristalCaja = document.getElementById(id);
  if(!cristalCaja) return;

  cristalCaja.addEventListener('click', () => {
    if(cristalCaja.classList.contains('inhabilitado')) return;

    if(IdentidadCristal === id){
      cerrarDetalleYUnir(id);
      return;
    }

    IdentidadCristal = id;
    ultimoRevisado = id;
    grillaCristales.classList.add("oculto");
    detalleCristal.classList.add("visible");
    detalleCristal.innerHTML = "";

    const nombreCristal = cristalCaja.querySelector("img").getAttribute("data-NombreCristal") || "Cristal";
    tituloPrincipal.style.display = "none";
    tituloCristal.textContent = nombreCristal;
    tituloCristal.style.display = "block";

    const CristalGrande = document.createElement("div");
    CristalGrande.className = "cristal-grande";
    const img = cristalCaja.querySelector("img");
    CristalGrande.innerHTML = `<img src="${img.src}" alt="">`;
    CristalGrande.addEventListener("click", () => cerrarDetalleYUnir(id));

    const CristalCampoTexto = document.createElement("div");
    CristalCampoTexto.className = "textoCampo";
        switch(id){
          case "cRosa":    
            CristalCampoTexto.innerHTML="<small>Aquellas personas que llevan este cristal suelen irradiar una energía positiva, lo que les permite afrontar los desafíos de la vida con calma y equilibrio. Su vibración está estrechamente asociada con la creatividad y la capacidad de ver el mundo desde perspectivas distintas. Este cristal conecta con linajes familiares en los que la sensibilidad, la intuición y la inventiva han estado siempre presentes.</small>"; 
            break;
          case "cVioleta": 
            CristalCampoTexto.innerHTML="<small>Esta piedra simboliza a las personas serenas, las que encuentran equilibrio  medio del caos. Su energía transmite calma y confianza. Está profundamente conectada con la intuición, potenciando la capacidad de percibir lo que no siempre se ve a simple vista. Quienes la llevan suelen guiarse por su instinto de manera natural.</small>"; 
            break;
          case "cVerde":   
            CristalCampoTexto.innerHTML="<small>Se trata de una piedra sagrada y armónica, su vibración conecta profundamente con la tierra y el equilibrio universal. Su energía transmite serenidad y respeto por todo lo vivo, recordando la importancia de mantener una relación consciente con la naturaleza. Proveniente de una familia con una gran conexión con el mundo natural, guarda en su interior la memoria de la tierra, los ríos y los bosques. Quienes la portan suelen sentir una afinidad especial por los entornos verdes.</small>"; 
            break;
          case "cAmarillo":
            CristalCampoTexto.innerHTML="<small>Esta piedra es la compañera ideal para quienes llevan dentro un espíritu ambicioso y perseverante, siempre en busca del éxito. Su energía actúa como un impulso constante hacia las metas, recordando que la confianza y la disciplina son claves para alcanzar los sueños más grandes. Proveniente de una tradición optimista y alegre, transmite entusiasmo y vitalidad a quienes la portan.</small>"; 
            break;
          case "cCeleste": 
            CristalCampoTexto.innerHTML="<small>Tras su fallecimiento, la piedra se ha convertido en un símbolo de su esencia y en un recordatorio vivo de todo lo que dejó a su pueblo. Su energía está entrelazada con la de Selen, como si en su interior quedara grabada su fuerza vital. Para la comunidad, representa la memoria de su legado: salud, prosperidad y la inspiración de una vida guiada por la armonía con la tierra.</small>"; 
            break;
        }

    detalleCristal.appendChild(CristalGrande);
    detalleCristal.appendChild(CristalCampoTexto);

    const imgUsado = cristalCaja.querySelector("img");
    if(imgUsado) imgUsado.classList.remove("palpitando");
  });
});

/* ---- click sobre fondoFinal ---- */
fondoFinal.addEventListener('click', () => {
  window.open('https://www.instagram.com/elowen_selen', '_blank');
});


</script>

</body>
</html>
